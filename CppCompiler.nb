(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46296,       1191]
NotebookOptionsPosition[     42586,       1080]
NotebookOutlinePosition[     42929,       1095]
CellTagsIndexPosition[     42886,       1092]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Compile to C++", "Section",
 CellChangeTimes->{{3.656117967852721*^9, 3.656117988851922*^9}, 
   3.656118036313637*^9, {3.657234857375698*^9, 3.657234861190917*^9}}],

Cell[TextData[{
 "The following code intends to compile a ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " compiled fucntion into C++. \nWolfram has a product to do this \
(http://www.wolfram.com/products/applications/mathcode/).\nHowever, it is too \
expensive (for me), and I am not intending to implement the complete C++ type \
system... \nMy compiler will try our best to compile, but allow missing \
something and require the programer to fill in the blank by hand.\n\nSeems \
like even \n\
http://www.mathematica-journal.com/2008/11/mathcode-a-system-for-c-or-fortran-\
code-generation-from-mathematica/"
}], "Text",
 CellChangeTimes->{{3.657234878928931*^9, 3.6572349179871655`*^9}, {
  3.657234956476367*^9, 3.657235008654351*^9}, {3.6572350931641846`*^9, 
  3.6572352173992906`*^9}, {3.6572368466344776`*^9, 3.657236850229683*^9}, {
  3.6572378543291144`*^9, 3.6572378613505163`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"\[Not]", 
    RowBox[{"ValueQ", "[", "cModp$", "]"}]}], ",", 
   RowBox[{"NotebookEvaluate", "[", 
    RowBox[{"NotebookOpen", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<tensorQ.nb\>\""}], 
       "}"}], "]"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6572379977983203`*^9, 3.65723805531161*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"CompiledFunction", "::", "cfn"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Numerical error encountered at instruction \
\[NoBreak]\\!\\(\\*RowBox[{\\\"4\\\"}]\\)\[NoBreak]; proceeding with \
uncompiled evaluation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/CompiledFunction/cfn\\\", ButtonNote -> \\\
\"CompiledFunction::cfn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6575862919189816`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Quotient", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \
\[NoBreak]\\!\\(\\*RowBox[{\\\"Quotient\\\", \\\"[\\\", RowBox[{\\\"1\\\", \\\
\",\\\", \\\"0\\\"}], \\\"]\\\"}]\\)\[NoBreak] encountered. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/infy\\\", \
ButtonNote -> \\\"Quotient::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6575862919589834`*^9}],

Cell[CellGroupData[{

Cell[BoxData["24"], "Print",
 CellChangeTimes->{3.657586292090991*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1"}], "}"}]], "Print",
 CellChangeTimes->{3.6575862920989914`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921009917`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1"}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921019917`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Print",
 CellChangeTimes->{3.657586292102992*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{
    RowBox[{"-", "1"}], "-", "\[ImaginaryI]"}]}], "}"}]], "Print",
 CellChangeTimes->{3.657586292103992*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "\[ImaginaryI]"}]}], "}"}]], "Print",
 CellChangeTimes->{3.657586292104992*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921059923`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "\[ImaginaryI]"}], "}"}]], "Print",
 CellChangeTimes->{3.657586292107992*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"1", "-", "\[ImaginaryI]"}]}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921089926`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"1", "+", "\[ImaginaryI]"}]}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921099925`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]], "Print",
 CellChangeTimes->{3.657586292136994*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.657586292138994*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921399937`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "1", ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Print",
 CellChangeTimes->{3.657586292140994*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "1", ",", 
   RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]], "Print",
 CellChangeTimes->{3.657586292142994*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "1", ",", "\[ImaginaryI]"}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921439943`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921449947`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921469946`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921479945`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921489944`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", "0", ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.657586292149995*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "\[ImaginaryI]", ",", "0", ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.657586292150995*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "0", ",", "1"}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921519947`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "1", ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921539946`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]], "Print",
 CellChangeTimes->{3.657586292155995*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "1"}], ",", "1", ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Print",
 CellChangeTimes->{3.657586292156995*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", "1", ",", 
   RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]], "Print",
 CellChangeTimes->{3.657586292158995*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "\[ImaginaryI]", ",", "1", ",", "\[ImaginaryI]"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.657586292159995*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "0", ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921609955`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", 
   RowBox[{"-", "1"}], ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.657586292161995*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921639957`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "1"}], ",", "1"}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921649957`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", 
   RowBox[{"-", "1"}], ",", "\[ImaginaryI]"}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921659956`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "\[ImaginaryI]", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921669955`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "0", ",", 
   RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921679955`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.657586292168996*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", 
   RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921709957`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", "\[ImaginaryI]"}], "}"}]], "Print",
 CellChangeTimes->{3.657586292171996*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Print",
 CellChangeTimes->{3.657586292172996*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "\[ImaginaryI]", ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", "1"}], "}"}]], "Print",
 CellChangeTimes->{3.657586292173996*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "1", ",", "0", ",", "\[ImaginaryI]"}], "}"}]], "Print",
 CellChangeTimes->{3.657586292174996*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "0", ",", "\[ImaginaryI]", ",", "0"}], "}"}]], "Print",
 CellChangeTimes->{3.657586292175996*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1", ",", "\[ImaginaryI]", ",", "\[ImaginaryI]"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.657586292176996*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "1"}], ",", "\[ImaginaryI]", ",", 
   RowBox[{"-", "\[ImaginaryI]"}]}], "}"}]], "Print",
 CellChangeTimes->{3.657586292177996*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "\[ImaginaryI]"}], ",", "\[ImaginaryI]", ",", "1"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.6575862921799965`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "\[ImaginaryI]", ",", "\[ImaginaryI]", ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Print",
 CellChangeTimes->{3.6575862921809964`*^9}],

Cell[BoxData["1"], "Print",
 CellChangeTimes->{3.657586292192997*^9}],

Cell[BoxData["1"], "Print",
 CellChangeTimes->{3.657586292197997*^9}],

Cell[BoxData["False"], "Print",
 CellChangeTimes->{3.6575862921989975`*^9}],

Cell[BoxData["1"], "Print",
 CellChangeTimes->{3.6575862922139983`*^9}],

Cell[BoxData["0"], "Print",
 CellChangeTimes->{3.6575862922490005`*^9}],

Cell[BoxData["False"], "Print",
 CellChangeTimes->{3.657586292278002*^9}],

Cell[BoxData["True"], "Print",
 CellChangeTimes->{3.657586292280002*^9}]
}, Open  ]],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "1"}], "+", 
   SuperscriptBox["p", "4"]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "p"}], ")"}], "3"]]], "Output",
 CellChangeTimes->{3.6574083307724333`*^9, 3.6574918685577602`*^9, 
  3.6575841425500445`*^9, 3.6575862976623096`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"freeVar", "[", 
   RowBox[{"prefix_", ",", "names_List"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", "=", "0"}], ",", 
      RowBox[{"prefixStr", "=", 
       RowBox[{"ToString", "[", "prefix", "]"}]}], ",", 
      RowBox[{"namesStr", "=", 
       RowBox[{"ToString", "/@", "names"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"MemberQ", "[", 
        RowBox[{"namesStr", ",", 
         RowBox[{"prefixStr", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}]}], "]"}], ",", 
       RowBox[{"i", "++"}]}], "]"}], ";", 
     RowBox[{"prefixStr", "<>", 
      RowBox[{"ToString", "[", "i", "]"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"freeVar", "[", 
  RowBox[{"d", ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "p"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"freeVar", "[", 
  RowBox[{"z", ",", 
   RowBox[{"{", 
    RowBox[{"z0", ",", "p"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.657410210277789*^9, 3.6574102129228296`*^9}, {
  3.657410256232996*^9, 3.6574103352642097`*^9}, {3.6574103655296745`*^9, 
  3.6574104692962685`*^9}, {3.6574107159375567`*^9, 3.6574107208676324`*^9}, {
  3.657410811709028*^9, 3.6574108267992597`*^9}, {3.657411204653016*^9, 
  3.657411307801757*^9}, {3.6574114464888873`*^9, 3.657411452398978*^9}}],

Cell[BoxData["\<\"d0\"\>"], "Output",
 CellChangeTimes->{{3.6574112720637083`*^9, 3.6574113100442915`*^9}, 
   3.6574117116779604`*^9, 3.657491868670767*^9, 3.6575841426560507`*^9, 
   3.657586297907324*^9}],

Cell[BoxData["\<\"z1\"\>"], "Output",
 CellChangeTimes->{{3.6574112720637083`*^9, 3.6574113100442915`*^9}, 
   3.6574117116779604`*^9, 3.657491868670767*^9, 3.6575841426560507`*^9, 
   3.6575862979083242`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"upCast", "[", "\[GothicH]s__", "]"}], ":=", 
  RowBox[{"Switch", "[", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"{", "\[GothicH]s", "}"}], "]"}], ",", "\[IndentingNewLine]", 
    "1", ",", 
    RowBox[{
     RowBox[{"{", "\[GothicH]s", "}"}], "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", "2", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", "\[GothicH]s", "}"}], "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], "\[Equal]", 
       RowBox[{
        RowBox[{"{", "\[GothicH]s", "}"}], "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], "\[Equal]", "\"\<int\>\""}], ",", 
      "\"\<int\>\"", ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", "\[GothicH]s", "}"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], "\[Equal]", 
         RowBox[{
          RowBox[{"{", "\[GothicH]s", "}"}], "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], "\[Equal]", "\"\<vector <int>\>\""}], 
        ",", "\"\<vector <int>\>\"", ",", "\"\<\>\""}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "_", ",", 
    RowBox[{"upCast", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[GothicH]s", "}"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}], ",", 
      RowBox[{"upCast", "@@", 
       RowBox[{"Rest", "[", 
        RowBox[{"{", "\[GothicH]s", "}"}], "]"}]}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"upCast", "[", 
  RowBox[{"\"\<int\>\"", ",", "\"\<int\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.657411393633075*^9, 3.657411407075782*^9}, {
  3.6574114542040057`*^9, 3.6574114545990114`*^9}, {3.6574121876628213`*^9, 
  3.657412299094195*^9}, {3.657492821861286*^9, 3.6574928315778418`*^9}, {
  3.657496128519416*^9, 3.6574961434762716`*^9}}],

Cell[BoxData["\<\"int\"\>"], "Output",
 CellChangeTimes->{3.657412300164256*^9, 3.657491868678767*^9, 
  3.657492840740366*^9, 3.657584142664051*^9, 3.6575862979163246`*^9}]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  FormBox["CppCompilerIn", TraditionalForm]]],
 " should return {type of a compiled function, body of a compiled function}"
}], "Text",
 CellChangeTimes->{{3.65741069530974*^9, 3.657410700119814*^9}, {
  3.6574108641483335`*^9, 3.657410904418952*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"cppCompilerIn", "[", 
   RowBox[{"body_", ",", "types_List", ",", "names_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Switch", "[", 
   RowBox[{
    RowBox[{"Head", "[", "body", "]"}], ",", "\[IndentingNewLine]", "Integer",
     ",", 
    RowBox[{"{", 
     RowBox[{"\"\<int\>\"", ",", 
      RowBox[{"ToString", "[", "body", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "Symbol", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Extract", "[", 
        RowBox[{"types", ",", 
         RowBox[{"Position", "[", 
          RowBox[{"names", ",", "body"}], "]"}]}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
      RowBox[{"ToString", "[", "body", "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "Times", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"upCast", "@@", 
         RowBox[{"(", 
          RowBox[{"First", "/@", "#"}], ")"}]}], ",", 
        RowBox[{"\"\<(\>\"", "<>", 
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "<>", 
         "\"\< * \>\"", "<>", 
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "<>", 
         "\"\<)\>\""}]}], "}"}], "&"}], "[", 
     RowBox[{
      RowBox[{
       RowBox[{"cppCompilerIn", "[", 
        RowBox[{"#", ",", "types", ",", "names"}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"body", "/.", 
        RowBox[{"Times", "\[Rule]", "List"}]}], ")"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "Plus", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"upCast", "@@", 
         RowBox[{"(", 
          RowBox[{"First", "/@", "#"}], ")"}]}], ",", 
        RowBox[{"\"\<(\>\"", "<>", 
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "<>", 
         "\"\< + \>\"", "<>", 
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "<>", 
         "\"\<)\>\""}]}], "}"}], "&"}], "[", 
     RowBox[{
      RowBox[{
       RowBox[{"cppCompilerIn", "[", 
        RowBox[{"#", ",", "types", ",", "names"}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"body", "/.", 
        RowBox[{"Plus", "\[Rule]", "List"}]}], ")"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "Quotient", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"upCast", "@@", 
         RowBox[{"(", 
          RowBox[{"First", "/@", "#"}], ")"}]}], ",", 
        RowBox[{"\"\<(\>\"", "<>", 
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "<>", 
         "\"\< / \>\"", "<>", 
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "<>", 
         "\"\<)\>\""}]}], "}"}], "&"}], "[", 
     RowBox[{
      RowBox[{
       RowBox[{"cppCompilerIn", "[", 
        RowBox[{"#", ",", "types", ",", "names"}], "]"}], "&"}], "/@", 
      RowBox[{"(", 
       RowBox[{"body", "/.", 
        RowBox[{"Quotient", "\[Rule]", "List"}]}], ")"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "Mod", ",", "\[IndentingNewLine]", 
    RowBox[{"Switch", "[", 
     RowBox[{
      RowBox[{"Length", "[", "body", "]"}], ",", "\[IndentingNewLine]", "2", 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"upCast", "@@", 
           RowBox[{"(", 
            RowBox[{"First", "/@", "#"}], ")"}]}], ",", 
          RowBox[{"\"\<(\>\"", "<>", 
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "<>", 
           "\"\< % \>\"", "<>", 
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "<>", 
           "\"\<)\>\""}]}], "}"}], "&"}], "[", 
       RowBox[{
        RowBox[{
         RowBox[{"cppCompilerIn", "[", 
          RowBox[{"#", ",", "types", ",", "names"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"body", "/.", 
          RowBox[{"Mod", "\[Rule]", "List"}]}], ")"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"upCast", "@@", 
           RowBox[{"(", 
            RowBox[{"First", "/@", "#"}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"d", "=", 
              RowBox[{"freeVar", "[", 
               RowBox[{"\"\<d\>\"", ",", "names"}], "]"}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<[&](const \>\"", "<>", 
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], "<>", 
             "\"\< \>\"", "<>", "d", "<>", "\"\<){\\nreturn \>\"", "<>", "d", 
             "<>", "\"\< + (\>\"", "<>", 
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "<>", 
             "\"\< - \>\"", "<>", "d", "<>", "\"\<) % \>\"", "<>", 
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "<>", 
             "\"\<;\\n}(\>\"", "<>", 
             RowBox[{"#", "\[LeftDoubleBracket]", 
              RowBox[{"3", ",", "2"}], "\[RightDoubleBracket]"}], "<>", 
             "\"\<)\>\""}]}], "]"}]}], "}"}], "&"}], "[", 
       RowBox[{
        RowBox[{
         RowBox[{"cppCompilerIn", "[", 
          RowBox[{"#", ",", "types", ",", "names"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"body", "/.", 
          RowBox[{"Mod", "\[Rule]", "List"}]}], ")"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "_", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<\>\"", ",", 
        RowBox[{"\"\<(\>\"", "<>", 
         RowBox[{"ToString", "[", "body", "]"}], "<>", "\"\<)\>\""}]}], 
       "}"}]}], "]"}], ",", "\[IndentingNewLine]", "_", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<\>\"", ",", 
      RowBox[{"\"\<(\>\"", "<>", 
       RowBox[{"ToString", "[", "body", "]"}], "<>", "\"\<)\>\""}]}], "}"}]}],
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cppCompilerIn", "[", 
  RowBox[{"p", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<int\>\"", ",", "\"\<int\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "p"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cppCompilerIn", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<int\>\"", ",", "\"\<int\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "p"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cppCompilerIn", "[", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<int\>\"", ",", "\"\<int\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "p"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cppCompilerIn", "[", 
  RowBox[{
   RowBox[{"-", "p"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<int\>\"", ",", "\"\<int\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "p"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cppCompilerIn", "[", 
  RowBox[{
   RowBox[{"1", "-", "p"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<int\>\"", ",", "\"\<int\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "p"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cppCompilerIn", "[", 
  RowBox[{
   RowBox[{"Quotient", "[", 
    RowBox[{
     RowBox[{"1", " ", "-", " ", "p"}], ",", " ", "2"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"\"\<int\>\"", ",", "\"\<int\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "p"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cppCompilerIn", "[", 
  RowBox[{
   RowBox[{"Mod", "[", 
    RowBox[{"z", ",", " ", "p", ",", " ", 
     RowBox[{"Quotient", "[", 
      RowBox[{
       RowBox[{"1", " ", "-", " ", "p"}], ",", " ", "2"}], "]"}]}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"\"\<int\>\"", ",", "\"\<int\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "p"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"cppCompilerIn", "[", 
  RowBox[{
   RowBox[{"Mod", "[", 
    RowBox[{"d0", ",", " ", "p", ",", " ", 
     RowBox[{"Quotient", "[", 
      RowBox[{
       RowBox[{"1", " ", "-", " ", "p"}], ",", " ", "2"}], "]"}]}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"\"\<int\>\"", ",", "\"\<int\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"d0", ",", "p"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.657408688805401*^9, 3.6574089442893257`*^9}, {
   3.6574094908417387`*^9, 3.6574095166996355`*^9}, {3.657409564757874*^9, 
   3.6574095873157206`*^9}, {3.6574096360214686`*^9, 
   3.6574096692469788`*^9}, {3.657409711922634*^9, 3.657409764293439*^9}, {
   3.6574098058140764`*^9, 3.657409824709367*^9}, {3.65741013873419*^9, 
   3.6574101554919477`*^9}, {3.657410520967062*^9, 3.6574105418223825`*^9}, {
   3.6574106501390457`*^9, 3.6574106557516327`*^9}, {3.657410710472473*^9, 
   3.657410733932833*^9}, {3.6574107714009085`*^9, 3.657410799413839*^9}, {
   3.6574113270245523`*^9, 3.657411338089722*^9}, {3.6574114590240793`*^9, 
   3.657411478691882*^9}, {3.657412338838468*^9, 3.6574124491167755`*^9}, {
   3.6574125291813545`*^9, 3.6574126580637264`*^9}, {3.6574129462372093`*^9, 
   3.65741302073147*^9}, {3.6574131595634108`*^9, 3.6574133352164574`*^9}, {
   3.6574133670882807`*^9, 3.657413378337924*^9}, {3.657413410404758*^9, 
   3.6574134241375437`*^9}, {3.6574134548182983`*^9, 
   3.6574135719259963`*^9}, {3.6574136139794016`*^9, 3.657413641014948*^9}, {
   3.6574136814292593`*^9, 3.657413684743449*^9}, {3.6574137438928328`*^9, 
   3.6574140257339525`*^9}, {3.657414057800787*^9, 3.6574140995961776`*^9}, {
   3.6574141518691673`*^9, 3.6574142499877796`*^9}, {3.6574143522395086`*^9, 
   3.6574143623195224`*^9}, {3.6574144317296195`*^9, 
   3.6574144374696274`*^9}, {3.6574144693196726`*^9, 
   3.6574144857896957`*^9}, {3.657414583349832*^9, 3.657414584169833*^9}, {
   3.657414731290039*^9, 3.657414737740048*^9}, {3.657414819820163*^9, 
   3.6574150100104294`*^9}, {3.6574921822147007`*^9, 3.657492185475887*^9}, {
   3.6574922325355787`*^9, 3.6574922457483344`*^9}, 3.657492276765108*^9, {
   3.6574923210756426`*^9, 3.657492333771369*^9}, {3.657492427380723*^9, 
   3.657492437700313*^9}, {3.65749259901654*^9, 3.6574926048788753`*^9}, {
   3.657492656813846*^9, 3.6574926684545116`*^9}, {3.657492781285965*^9, 
   3.65749280970059*^9}, {3.657492852384032*^9, 3.6574929112613993`*^9}, {
   3.6574938097537904`*^9, 3.657493881827913*^9}, {3.6574945050275574`*^9, 
   3.6574945056095905`*^9}, {3.657494541911667*^9, 3.657494657062254*^9}, {
   3.657494717211694*^9, 3.6574947176087165`*^9}, 3.657495365872795*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"int\"\>", ",", "\<\"p\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.657413751171249*^9, 3.6574138135438166`*^9}, {
   3.657413865311777*^9, 3.657413879366581*^9}, {3.657413941146115*^9, 
   3.657413986594714*^9}, {3.65741404439002*^9, 3.657414069899479*^9}, 
   3.6574141055915203`*^9, {3.657414210065496*^9, 3.657414252393917*^9}, {
   3.6574143533695097`*^9, 3.657414363269524*^9}, 3.657414442419635*^9, {
   3.6574144766696825`*^9, 3.6574144886896996`*^9}, 3.6574148909002624`*^9, {
   3.6574149961004095`*^9, 3.6574150160404377`*^9}, 3.6574918687287703`*^9, 
   3.6574921864169407`*^9, 3.657492277864171*^9, 3.6574923458160577`*^9, 
   3.6574924390913925`*^9, {3.6574926605380588`*^9, 3.657492676505972*^9}, {
   3.6574928448846025`*^9, 3.6574928586763916`*^9}, 3.657492912271457*^9, 
   3.6574938873772297`*^9, {3.657494616465932*^9, 3.657494658192318*^9}, 
   3.657494720059857*^9, 3.6574953718441367`*^9, 3.657584142697053*^9, 
   3.657586297943326*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"int\"\>", ",", "\<\"1\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.657413751171249*^9, 3.6574138135438166`*^9}, {
   3.657413865311777*^9, 3.657413879366581*^9}, {3.657413941146115*^9, 
   3.657413986594714*^9}, {3.65741404439002*^9, 3.657414069899479*^9}, 
   3.6574141055915203`*^9, {3.657414210065496*^9, 3.657414252393917*^9}, {
   3.6574143533695097`*^9, 3.657414363269524*^9}, 3.657414442419635*^9, {
   3.6574144766696825`*^9, 3.6574144886896996`*^9}, 3.6574148909002624`*^9, {
   3.6574149961004095`*^9, 3.6574150160404377`*^9}, 3.6574918687287703`*^9, 
   3.6574921864169407`*^9, 3.657492277864171*^9, 3.6574923458160577`*^9, 
   3.6574924390913925`*^9, {3.6574926605380588`*^9, 3.657492676505972*^9}, {
   3.6574928448846025`*^9, 3.6574928586763916`*^9}, 3.657492912271457*^9, 
   3.6574938873772297`*^9, {3.657494616465932*^9, 3.657494658192318*^9}, 
   3.657494720059857*^9, 3.6574953718441367`*^9, 3.657584142697053*^9, 
   3.657586297944326*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"int\"\>", ",", "\<\"-1\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.657413751171249*^9, 3.6574138135438166`*^9}, {
   3.657413865311777*^9, 3.657413879366581*^9}, {3.657413941146115*^9, 
   3.657413986594714*^9}, {3.65741404439002*^9, 3.657414069899479*^9}, 
   3.6574141055915203`*^9, {3.657414210065496*^9, 3.657414252393917*^9}, {
   3.6574143533695097`*^9, 3.657414363269524*^9}, 3.657414442419635*^9, {
   3.6574144766696825`*^9, 3.6574144886896996`*^9}, 3.6574148909002624`*^9, {
   3.6574149961004095`*^9, 3.6574150160404377`*^9}, 3.6574918687287703`*^9, 
   3.6574921864169407`*^9, 3.657492277864171*^9, 3.6574923458160577`*^9, 
   3.6574924390913925`*^9, {3.6574926605380588`*^9, 3.657492676505972*^9}, {
   3.6574928448846025`*^9, 3.6574928586763916`*^9}, 3.657492912271457*^9, 
   3.6574938873772297`*^9, {3.657494616465932*^9, 3.657494658192318*^9}, 
   3.657494720059857*^9, 3.6574953718441367`*^9, 3.657584142697053*^9, 
   3.657586297945326*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"int\"\>", ",", "\<\"(-1 * p)\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.657413751171249*^9, 3.6574138135438166`*^9}, {
   3.657413865311777*^9, 3.657413879366581*^9}, {3.657413941146115*^9, 
   3.657413986594714*^9}, {3.65741404439002*^9, 3.657414069899479*^9}, 
   3.6574141055915203`*^9, {3.657414210065496*^9, 3.657414252393917*^9}, {
   3.6574143533695097`*^9, 3.657414363269524*^9}, 3.657414442419635*^9, {
   3.6574144766696825`*^9, 3.6574144886896996`*^9}, 3.6574148909002624`*^9, {
   3.6574149961004095`*^9, 3.6574150160404377`*^9}, 3.6574918687287703`*^9, 
   3.6574921864169407`*^9, 3.657492277864171*^9, 3.6574923458160577`*^9, 
   3.6574924390913925`*^9, {3.6574926605380588`*^9, 3.657492676505972*^9}, {
   3.6574928448846025`*^9, 3.6574928586763916`*^9}, 3.657492912271457*^9, 
   3.6574938873772297`*^9, {3.657494616465932*^9, 3.657494658192318*^9}, 
   3.657494720059857*^9, 3.6574953718441367`*^9, 3.657584142697053*^9, 
   3.657586297947326*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"int\"\>", ",", "\<\"(1 + (-1 * p))\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.657413751171249*^9, 3.6574138135438166`*^9}, {
   3.657413865311777*^9, 3.657413879366581*^9}, {3.657413941146115*^9, 
   3.657413986594714*^9}, {3.65741404439002*^9, 3.657414069899479*^9}, 
   3.6574141055915203`*^9, {3.657414210065496*^9, 3.657414252393917*^9}, {
   3.6574143533695097`*^9, 3.657414363269524*^9}, 3.657414442419635*^9, {
   3.6574144766696825`*^9, 3.6574144886896996`*^9}, 3.6574148909002624`*^9, {
   3.6574149961004095`*^9, 3.6574150160404377`*^9}, 3.6574918687287703`*^9, 
   3.6574921864169407`*^9, 3.657492277864171*^9, 3.6574923458160577`*^9, 
   3.6574924390913925`*^9, {3.6574926605380588`*^9, 3.657492676505972*^9}, {
   3.6574928448846025`*^9, 3.6574928586763916`*^9}, 3.657492912271457*^9, 
   3.6574938873772297`*^9, {3.657494616465932*^9, 3.657494658192318*^9}, 
   3.657494720059857*^9, 3.6574953718441367`*^9, 3.657584142697053*^9, 
   3.657586297948326*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"int\"\>", ",", "\<\"((1 + (-1 * p)) / 2)\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.657413751171249*^9, 3.6574138135438166`*^9}, {
   3.657413865311777*^9, 3.657413879366581*^9}, {3.657413941146115*^9, 
   3.657413986594714*^9}, {3.65741404439002*^9, 3.657414069899479*^9}, 
   3.6574141055915203`*^9, {3.657414210065496*^9, 3.657414252393917*^9}, {
   3.6574143533695097`*^9, 3.657414363269524*^9}, 3.657414442419635*^9, {
   3.6574144766696825`*^9, 3.6574144886896996`*^9}, 3.6574148909002624`*^9, {
   3.6574149961004095`*^9, 3.6574150160404377`*^9}, 3.6574918687287703`*^9, 
   3.6574921864169407`*^9, 3.657492277864171*^9, 3.6574923458160577`*^9, 
   3.6574924390913925`*^9, {3.6574926605380588`*^9, 3.657492676505972*^9}, {
   3.6574928448846025`*^9, 3.6574928586763916`*^9}, 3.657492912271457*^9, 
   3.6574938873772297`*^9, {3.657494616465932*^9, 3.657494658192318*^9}, 
   3.657494720059857*^9, 3.6574953718441367`*^9, 3.657584142697053*^9, 
   3.6575862979493265`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"int\"\>", 
   ",", "\<\"[&](const int d0){\\nreturn d0 + (z - d0) % p;\\n}(((1 + (-1 * \
p)) / 2))\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.657413751171249*^9, 3.6574138135438166`*^9}, {
   3.657413865311777*^9, 3.657413879366581*^9}, {3.657413941146115*^9, 
   3.657413986594714*^9}, {3.65741404439002*^9, 3.657414069899479*^9}, 
   3.6574141055915203`*^9, {3.657414210065496*^9, 3.657414252393917*^9}, {
   3.6574143533695097`*^9, 3.657414363269524*^9}, 3.657414442419635*^9, {
   3.6574144766696825`*^9, 3.6574144886896996`*^9}, 3.6574148909002624`*^9, {
   3.6574149961004095`*^9, 3.6574150160404377`*^9}, 3.6574918687287703`*^9, 
   3.6574921864169407`*^9, 3.657492277864171*^9, 3.6574923458160577`*^9, 
   3.6574924390913925`*^9, {3.6574926605380588`*^9, 3.657492676505972*^9}, {
   3.6574928448846025`*^9, 3.6574928586763916`*^9}, 3.657492912271457*^9, 
   3.6574938873772297`*^9, {3.657494616465932*^9, 3.657494658192318*^9}, 
   3.657494720059857*^9, 3.6574953718441367`*^9, 3.657584142697053*^9, 
   3.6575862979503264`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"int\"\>", 
   ",", "\<\"[&](const int d1){\\nreturn d1 + (d0 - d1) % p;\\n}(((1 + (-1 * \
p)) / 2))\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.657413751171249*^9, 3.6574138135438166`*^9}, {
   3.657413865311777*^9, 3.657413879366581*^9}, {3.657413941146115*^9, 
   3.657413986594714*^9}, {3.65741404439002*^9, 3.657414069899479*^9}, 
   3.6574141055915203`*^9, {3.657414210065496*^9, 3.657414252393917*^9}, {
   3.6574143533695097`*^9, 3.657414363269524*^9}, 3.657414442419635*^9, {
   3.6574144766696825`*^9, 3.6574144886896996`*^9}, 3.6574148909002624`*^9, {
   3.6574149961004095`*^9, 3.6574150160404377`*^9}, 3.6574918687287703`*^9, 
   3.6574921864169407`*^9, 3.657492277864171*^9, 3.6574923458160577`*^9, 
   3.6574924390913925`*^9, {3.6574926605380588`*^9, 3.657492676505972*^9}, {
   3.6574928448846025`*^9, 3.6574928586763916`*^9}, 3.657492912271457*^9, 
   3.6574938873772297`*^9, {3.657494616465932*^9, 3.657494658192318*^9}, 
   3.657494720059857*^9, 3.6574953718441367`*^9, 3.657584142697053*^9, 
   3.6575862979513264`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetAttributes", "[", 
  RowBox[{"cppCompiler", ",", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cppCompiler", "[", "f_Symbol", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"argtypes", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"#", "===", "_Integer"}], ",", "\"\<int\>\"", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", "===", 
              RowBox[{"{", 
               RowBox[{"_Integer", ",", "1"}], "}"}]}], ",", 
             "\"\<vector <int>\>\"", ",", 
             RowBox[{"ToString", "[", "#", "]"}]}], "]"}]}], "]"}], "&"}], "/@", 
        RowBox[{
        "f", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"argnames", "=", 
       RowBox[{"f", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"body", "=", 
       RowBox[{"f", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"-", "2"}], ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
      "\[IndentingNewLine]", "compiledCode"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"compiledCode", "=", 
      RowBox[{"cppCompilerIn", "[", 
       RowBox[{"body", ",", "argtypes", ",", "argnames"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"First", "[", "compiledCode", "]"}], "<>", "\"\< \>\"", "<>", 
      RowBox[{"SymbolName", "[", 
       RowBox[{"Unevaluated", "[", "f", "]"}], "]"}], "<>", "\"\<(\>\"", "<>", 
      RowBox[{"StringTake", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\"\<const \>\"", "<>", "#1", "<>", "\"\< \>\"", "<>", 
             RowBox[{"ToString", "[", "#2", "]"}]}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"argtypes", ",", "argnames"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", 
          RowBox[{"-", "2"}]}], "}"}]}], "]"}], "<>", "\"\<){\\nreturn \>\"", 
      "<>", 
      RowBox[{"Last", "[", "compiledCode", "]"}], "<>", "\"\<;\\n}\>\""}]}]}],
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cppCompiler", "[", "cTimes$", "]"}]}], "Input",
 CellChangeTimes->{{3.657235227994897*^9, 3.657235371735118*^9}, {
   3.6572354360977993`*^9, 3.65723551757146*^9}, {3.6572355553986235`*^9, 
   3.657235564773159*^9}, {3.657235757243168*^9, 3.6572357584312363`*^9}, {
   3.6572358198487487`*^9, 3.6572359466410007`*^9}, {3.6572381496190042`*^9, 
   3.657238171174237*^9}, {3.6572382221531525`*^9, 3.6572382892869925`*^9}, {
   3.6572383443211403`*^9, 3.65723837299378*^9}, {3.657238418982411*^9, 
   3.657238488237372*^9}, {3.6572385258705244`*^9, 3.657238557774349*^9}, {
   3.6572387100220575`*^9, 3.6572387128582196`*^9}, {3.6572387461161213`*^9, 
   3.657238850432088*^9}, {3.657239267215927*^9, 3.6572393370849233`*^9}, {
   3.65723939070599*^9, 3.6572394384637213`*^9}, 3.6574087656590815`*^9, {
   3.657410116163843*^9, 3.6574101351716356`*^9}, {3.6574105651402407`*^9, 
   3.657410642306426*^9}, {3.657411472136781*^9, 3.657411491077072*^9}, 
   3.657492262752307*^9, {3.6574927434558015`*^9, 3.6574927631059256`*^9}, {
   3.657494323496175*^9, 3.657494323910198*^9}, {3.657494709470251*^9, 
   3.657494709872274*^9}, {3.657495611052819*^9, 3.6574956395334473`*^9}, {
   3.657495682270892*^9, 3.6574956963386965`*^9}, {3.6574958002976427`*^9, 
   3.6574958472843304`*^9}, {3.657495900660383*^9, 3.657495902922513*^9}, 
   3.657496094393464*^9, {3.657496176715173*^9, 3.6574961840275908`*^9}, {
   3.6575860419716854`*^9, 3.65758604904709*^9}, {3.657586221050928*^9, 
   3.6575862253711753`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(\\*RowBox[{\\\"q\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\)\
\[NoBreak] is longer than depth of object. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partd\\\", ButtonNote -> \
\\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.657586260052159*^9, 3.6575862980033293`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(\\*RowBox[{\\\"q\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\)\
\[NoBreak] is longer than depth of object. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partd\\\", ButtonNote -> \
\\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.657586260052159*^9, 3.6575862980433316`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Part", "::", "partd"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Part specification \[NoBreak]\\!\\(\\*RowBox[{\\\"r\\\", \
\\\"\[LeftDoubleBracket]\\\", \\\"2\\\", \\\"\[RightDoubleBracket]\\\"}]\\)\
\[NoBreak] is longer than depth of object. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partd\\\", ButtonNote -> \
\\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.657586260052159*^9, 3.657586298082334*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during \
this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.657586260052159*^9, 3.6575862981083355`*^9}],

Cell[BoxData["\<\" cTimes$(const vector <int> q, const vector <int> \
r){\\nreturn ({q[[1]] r[[1]] - q[[2]] r[[2]], q[[2]] r[[1]] + q[[1]] \
r[[2]]});\\n}\"\>"], "Output",
 CellChangeTimes->{
  3.657238281642555*^9, 3.6572384896764545`*^9, 3.6572385314548435`*^9, {
   3.6572388300769243`*^9, 3.6572388512001324`*^9}, {3.6572393031779838`*^9, 
   3.657239311521461*^9}, 3.6572394416079016`*^9, 3.6574083308849354`*^9, 
   3.657409830836961*^9, 3.6574918688447766`*^9, 3.65749268241831*^9, 
   3.657492916253685*^9, 3.657493928571586*^9, 3.6574943280534353`*^9, 
   3.657494689316098*^9, 3.6574947289473653`*^9, 3.6574953783215075`*^9, 
   3.657496184994646*^9, 3.657584142715054*^9, 3.657586196540526*^9, 
   3.6575862604971843`*^9, 3.657586298109336*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cppCompiler", "[", "cModp$", "]"}]], "Input"],

Cell[BoxData["\<\"int cModp$(const int z, const int p){\\nreturn [&](const \
int d0){\\nreturn d0 + (z - d0) % p;\\n}(((1 + (-1 * p)) / 2));\\n}\"\>"], \
"Output",
 CellChangeTimes->{3.6575862981153355`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1103, 810},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.3 for Microsoft Windows (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 171, 2, 70, "Section"],
Cell[754, 26, 900, 16, 144, "Text"],
Cell[CellGroupData[{
Cell[1679, 46, 461, 12, 31, "Input"],
Cell[2143, 60, 544, 11, 21, "Message"],
Cell[2690, 73, 544, 11, 21, "Message"],
Cell[CellGroupData[{
Cell[3259, 88, 70, 1, 23, "Print"],
Cell[3332, 91, 116, 3, 23, "Print"],
Cell[3451, 96, 116, 3, 23, "Print"],
Cell[3570, 101, 116, 3, 23, "Print"],
Cell[3689, 106, 133, 4, 23, "Print"],
Cell[3825, 112, 170, 5, 23, "Print"],
Cell[3998, 119, 170, 5, 23, "Print"],
Cell[4171, 126, 147, 4, 23, "Print"],
Cell[4321, 132, 126, 3, 23, "Print"],
Cell[4450, 137, 152, 4, 23, "Print"],
Cell[4605, 143, 152, 4, 23, "Print"],
Cell[4760, 149, 134, 3, 23, "Print"],
Cell[4897, 154, 134, 3, 23, "Print"],
Cell[5034, 159, 136, 3, 23, "Print"],
Cell[5173, 164, 153, 4, 23, "Print"],
Cell[5329, 170, 165, 4, 23, "Print"],
Cell[5497, 176, 148, 3, 23, "Print"],
Cell[5648, 181, 136, 3, 23, "Print"],
Cell[5787, 186, 136, 3, 23, "Print"],
Cell[5926, 191, 136, 3, 23, "Print"],
Cell[6065, 196, 155, 4, 23, "Print"],
Cell[6223, 202, 165, 4, 23, "Print"],
Cell[6391, 208, 146, 3, 23, "Print"],
Cell[6540, 213, 136, 3, 23, "Print"],
Cell[6679, 218, 136, 3, 23, "Print"],
Cell[6818, 223, 134, 3, 23, "Print"],
Cell[6955, 228, 172, 5, 23, "Print"],
Cell[7130, 235, 196, 5, 23, "Print"],
Cell[7329, 242, 161, 4, 23, "Print"],
Cell[7493, 248, 155, 4, 23, "Print"],
Cell[7651, 254, 153, 4, 23, "Print"],
Cell[7807, 260, 174, 5, 23, "Print"],
Cell[7984, 267, 174, 5, 23, "Print"],
Cell[8161, 274, 198, 5, 23, "Print"],
Cell[8362, 281, 198, 5, 23, "Print"],
Cell[8563, 288, 167, 4, 23, "Print"],
Cell[8733, 294, 165, 4, 23, "Print"],
Cell[8901, 300, 198, 5, 23, "Print"],
Cell[9102, 307, 196, 5, 23, "Print"],
Cell[9301, 314, 215, 6, 23, "Print"],
Cell[9519, 322, 177, 4, 23, "Print"],
Cell[9699, 328, 146, 3, 23, "Print"],
Cell[9848, 333, 146, 3, 23, "Print"],
Cell[9997, 338, 161, 4, 23, "Print"],
Cell[10161, 344, 196, 5, 23, "Print"],
Cell[10360, 351, 182, 5, 23, "Print"],
Cell[10545, 358, 179, 4, 23, "Print"],
Cell[10727, 364, 69, 1, 23, "Print"],
Cell[10799, 367, 69, 1, 23, "Print"],
Cell[10871, 370, 75, 1, 23, "Print"],
Cell[10949, 373, 71, 1, 23, "Print"],
Cell[11023, 376, 71, 1, 23, "Print"],
Cell[11097, 379, 73, 1, 23, "Print"],
Cell[11173, 382, 72, 1, 23, "Print"]
}, Open  ]],
Cell[11260, 386, 328, 10, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11625, 401, 1407, 36, 112, "Input"],
Cell[13035, 439, 207, 3, 31, "Output"],
Cell[13245, 444, 209, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13491, 452, 1942, 46, 112, "Input"],
Cell[15436, 500, 173, 2, 31, "Output"]
}, Open  ]],
Cell[15624, 505, 282, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[15931, 515, 10973, 257, 612, "Input"],
Cell[26907, 774, 1006, 15, 31, "Output"],
Cell[27916, 791, 1006, 15, 31, "Output"],
Cell[28925, 808, 1007, 15, 31, "Output"],
Cell[29935, 825, 1013, 15, 31, "Output"],
Cell[30951, 842, 1019, 15, 31, "Output"],
Cell[31973, 859, 1030, 16, 31, "Output"],
Cell[33006, 877, 1085, 17, 72, "Output"],
Cell[34094, 896, 1086, 17, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35217, 918, 3936, 81, 252, "Input"],
Cell[39156, 1001, 579, 11, 21, "Message"],
Cell[39738, 1014, 579, 11, 21, "Message"],
Cell[40320, 1027, 577, 11, 21, "Message"],
Cell[40900, 1040, 584, 12, 21, "Message"],
Cell[41487, 1054, 755, 11, 72, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42279, 1070, 69, 1, 31, "Input"],
Cell[42351, 1073, 207, 3, 112, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
